name: Trigger Rebuild

on:
  push:
    branches: [main]
    paths:
      - 'people/**'
      - 'shipped/**'

jobs:
  rebuild:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Vercel rebuilds
        run: |
          echo "Triggering vibecoder.md rebuild..."
          curl -X POST "${{ secrets.VERCEL_HOOK_VIBECODER }}" || true

          echo "Triggering pages.md rebuild..."
          curl -X POST "${{ secrets.VERCEL_HOOK_PAGES }}" || true

          echo "Triggering shipped.md rebuild..."
          curl -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.MONOREPO_PAT }}" \
            https://api.github.com/repos/igindin/vibecoding/dispatches \
            -d '{"event_type":"deploy-shipped"}' || true

          echo "All rebuilds triggered!"
